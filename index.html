<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">

    <title>SSVEP</title>
    <style type="text/css">
        * { margin: 0; padding: 0;}

        body, html { height:100%; }

        canvas {
            
            width:50%;
            height:99%;
        }
    </style>
    <script src="http://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script>
</head>

<body>
    <canvas height="1" id="left" width="1"></canvas><canvas height="1" id="right" width="1"></canvas> 
    <script>
        var left_step_size = 1000/(2*7);
        var right_step_size = 1000/(2*12);
        
        function getFrequencies() {
            var frequencies = prompt("EPILEPSY\nWARNING\n\nA few people may experience " +
                                     "epileptic seizures when viewing flashing lights.\n\n" + 
                                     "Please enter the desired frequencies, e.g. 7,12 " +
                                     "for a left eye frequency of 7 Hz, and right eye " +
                                     "frequency of 12 Hz.", "7,12");
            var left = frequencies.split(",")[0];
            var right = frequencies.split(",")[1];
            left_step_size = 1000/(2*parseInt(left));
            right_step_size = 1000/(2*parseInt(right));
        }
        
        var step_left = 0;
        function drawLeft() {
            var my_canvas = document.getElementById("left");
            var my_context = my_canvas.getContext("2d");
            my_context.fillStyle = step_left++ % 2 == 0 ? "black" : "white";
            my_context.fillRect(0,0, 10000,10000);
        }

        var step_right = 0;
        function drawRight() {
            var my_canvas = document.getElementById("right");
            var my_context = my_canvas.getContext("2d");
            my_context.fillStyle = step_right++ % 2 == 0 ? "black" : "white";
            my_context.fillRect(0,0, 10000,10000);
        }

        var left, right;
        var on = false;
        $(document).keypress(function(event) {
            if (event.which == 32) {
                if (on) {
                    clearInterval(left);
                    clearInterval(right);
                    on = false;
                }
                else {
                    left = setInterval(drawLeft, left_step_size);
                    right = setInterval(drawRight, right_step_size);
                    on = true;
                }            
            }
        })
        getFrequencies();
    </script>
</body>
</html>